/**
 * Respond Stylesheet
 *
 * Styles for the response section of the comment form. Note that the styles
 * for the currently logged-in user are kept in _meta.scss as they are shared
 * with the comments list.
 *
 * A lot of the comments markup is generated automatically by WordPress, making
 * it awkward to namespace. There is some heavy nesting here to migigate this.
 *
 * @package     danfoy_2019
 * @subpackage  comments
 * @author      Dan Foy <danfoy.com>
 * @since       1.0.0
 */

#respond {
    position: relative;             // Anchor #cancel-comment-reply-link
    margin: ($line / 2);                // Half gutters so text can align with body
    border: 1px solid $grey400;
    border-radius: ($line / 8);
    background-color: $grey200;

    // Resize to line up with content text at $medium-s
    @media (min-width: ($medium-s + ($line * 2))) {
        max-width: ($medium-s + $line);
        margin: $line auto;
    }

    a {
        color: $grey500;

        &:hover {
            text-decoration: none;
            color: $grey700;
        }
    }

    // Override: Trim respond to fit while nested
    @at-root .comment #respond {
        margin-top: $line/2;
        margin-bottom: 0;
    }

    // Cancel reply link generated by WordPress and controlled by a core script
    #cancel-comment-reply-link {
        position: absolute;
        top: -$line;
        left: 0;
        float: right;               // Line up with reply links
        font-size: $text-s;         // Match reply links

        &:before {
            content: "x";           // Close button
            padding-right: $text-s; // <space>
        }
    }

    // Labels should appear on form items when placeholder text is not supported
    .respond-form-label {
        display: block;
        margin: $line/2;
        font-size: $text-s;
        text-transform: uppercase;

        // Hide labels when placeholder text available
        @at-root .placeholder .respond-form-label {
            @include hide-visually;
        }
    }

    // form elements have half the margin of all other elements, but the
    // same again as padding. This makes their content line up with the
    // site content.
    .respond-form-element {
        font-family: $sans-serif;
        display: block;
        box-sizing: border-box;
        width: calc(100% - #{$line});
        margin: $line/2;
        padding: $line/2;
        color: $grey700;
        background-color: $grey100;
        border: 1px solid $grey400;
        border-radius: ($line / 8); // Override UAS for iOS

        &:first-of-type {
            margin-top: 0;          // Handled by container
        }

        // Note the centered text is affected by autofill buttons in Safari due
        // to the html5 text types - it's shifted to the left when the field
        // is active. I actually don't mind this because it highlights that
        // autofill information has become available.
        &::placeholder {
            text-transform: uppercase;
            font-size: $text-s;
            line-height: $line;
            font-weight: 700;
            color: $grey500;
        }

        // Separate styles for the comment textarea
        &.respond-form-input-comment {
            width: 100%;
            height: $line * 5;
            line-height: $line;
            margin: 0 0 ($line/2) 0;
            font-family: $serif;
            border: none;
            border-bottom: 1px solid $grey400;
            border-radius: 0;       // Override .respond-form-element

            // Override the custom rules from .respond-form-element::placeholder
            &::placeholder {
                text-transform: none;
                font-size: $text;
                font-weight: 400;
            }
        }
    }

    // Helper text re. comment formatting and email usage
    .respond-form-notice {
        font-size: $text-s;
        line-height: $text-s;
        margin: ($line / 2);
        margin-bottom: $line;
        cursor: default;
        color: $grey500;
    }

    // Checkbox to save comment details for subsequent visits
    .comment-form-cookies-consent {

        @extend .respond-form-notice;   // Looks same as .respond-form-notice

        position: relative;             // So input can be abs. positioned
        margin-left: $line;
        padding-left: ($line);          // Space for checkbox

        // Checkbox generated by WordPress
        input[type="checkbox"] {
            position: absolute;         // For faux indenting label text
            top: 0;
            left: 0;
            height: $text-s;            // Same height as label text
            width: $text-s;             // Square
            border: 1px solid $grey400;
            background-color: $grey200;
        }
    }


    .form-submit { // <p>, annoyingly added by comment_form();
        margin: 0;                      // Reset, added by UAS

        .submit { // <input type="submit">
            text-transform: uppercase;
            font-weight: bold;
            border-radius: ($line / 4);
            color: $grey700;
            cursor: pointer;            // Act like a button
        }
    }

}

.respond-closed {
    text-align: center;
    margin: ($line * 2) $line;
}
